---
title: Treading Through Taylor's Tracks
categories:
- General
feature_image: "https://picsum.photos/2560/600?image=872"
---

As a third part of our [Taylor Series](https://mathworld.wolfram.com/TaylorSeries.html), we want to check what songs are sonically and lyrically connected. With that we will use the audio features from Spotify and the created lexical ratios based on our [first blog](https://sonic-edgehog.github.io/general/2021/04/04/ts-blog-001/). For the full codes and implementation, see the corresponding notebook `ts_liners.ipynb` in the [codes](https://github.com/sonic-edgehog/sonic-edgehog.github.io/tree/main/codes) folder.

{% include lib/mathjax.html %}

## Searching for Sonical Similarity

To check how sonically close are her songs, we standardized the features extracted from Spotify and from the 167 songs, we created a distance matrix using the euclidean distance. The metric is defined as follows. The closer the value to 0, the more sonically similar are the songs. In our code block we will use below, we will find the angle that is above and close to **0**, indicating perfect similarity.

$$ 
\begin{aligned}
distance = \sqrt{\sum_{i=1}^{N} (x_{i} - y_{i})^{2}}
\end{aligned}
$$

To create the distance matrix, we used the following codeblock.

```python
from sklearn.metrics.pairwise import pairwise_distances
from scipy.spatial.distance import cosine
sound_feature_array = ts_sound_standard['features_list'].values.tolist()
ts_songs_all = ts_sound_standard['song_album'].values.tolist()
cos_sim = pairwise_distances(sound_feature_array, metric = "euclidean")
cos_sim = pd.DataFrame(cos_sim, index=ts_songs_all, columns=ts_songs_all)
```

From the matrix itself, we will identify the 20 most similar and dissimilar pair of tracks across the discography and for that, we used the following code blocks to generate the list. For the most similar tracks, Christopher Rowe, the main producer from `Fearless (Taylor's Version)` is able to replicate properly what Nathan Chapman has produced from the old version of `Fearless`. Furthermore, the top pair has both Max Martin and Shellback as the producers and Martin as the co-writer, indicating his heavy influence in `1989`.

{% include ts_sonic_top20_pair.html %}

**Table 1.**  Although eleven pairs came from both versions of `fearless` in which **seven** are re-recordings, a pair of songs from `1989` tops the list.

As for the most dissimilar tracks, `long story short` from `evermore` occupy 14 of the 20 pairs and it is the furthest track from the origin, followed by `gold rush` from the same album. Based on the first blog, `evermore` has the least cohesive tracks hence the dissimilar pairs came from that album.

{% include ts_sonic_bot20_pair.html %}

**Table 2.** The top three furthest tracks are least one of the members of the twenty most dissimilar pairs.

## Looking for lyrical likeness

As for the lyrics of the tracks, we will proceed in two ways. We will use the lyrics themselves and we will clean them afterwards by removing common words. Furthermore, we will rank them according to how likely the lyrics and the choruses are, respectively. 

The idea is to graph all songs by their closeness. Hence, we apply a `jaccard` distance to the `lyric_set` for each. Then, we convert them into graph based on a particular threshold. The `jaccard` distance is defined as such where `A` and `B` are sets. The closer to zero, the nearer. The distance determines how similar a pair of unique set of words.

$$ 
\begin{aligned}
distance = 1- \frac{|A \cap B|}{|A \cup B|}
\end{aligned}
$$

```python
from sklearn.preprocessing import StandardScaler
ts_lyric_sound_standard[new_features] = StandardScaler().fit_transform(ts_lyric_sound_standard[new_features])
```

To check how the distributions of the respective features could affect our model, we graph them. We excluded the `instrumentalness` feature since it has **57** values of **0**.


{% include ts_combi_distribution.html %}

**Figure 1.** `Valence`, `tempo`, and `lexical uniqueness` have similar distributions.

Finally, we used heatmaps to graph the difference in correlation matrices between the two classes. In our dataset, we have **128** non-Track Fives and **9** Track Fives.


{% include ts_combi_heatmap_track5.html %}

**Figure 2.** The correlations between `speechiness` and **7** other features are negatively associated.

It seems that the the fifth tracks have shown better association among the features compared to the other tracks. As shown in our table below, the column with the lowest track `valence` per album is comprised of mostly track fives.


{% include taylor_table_low_sound.html %}

**Table 1.** Seven out of nine Track Five songs occupied **12** of the seventy-two positions.


{% include ts_combi_heatmap_notrack5.html %}

**Figure 2.** Almost half of the correlations are below the absolute value of **0.10**.

## Using the `h2o` package

[H2o package](https://www.h2o.ai/) is an open source model building and optimization. We will use it to run a classification model and find the most important features. In particular, we will use Random Forest with the package `H2ORandomForestEstimator`. Since the model runs only with `h2oframe`, we convert it first by using `h2o.H2OFrame` and as for the label, we convert it into factor by using the `asfactor` function.

In separating the training dataset form the testing dataset, we include all tracks from the first album to `reputation` and first few tracks in `Lover`. The testing dataset will be the rest of the discography. 

|                	| Training 	| Testing 	|
|----------------	|----------	|---------	|
| Track Five     	| 7        	| 2       	|
| Non-Track Five 	| 90       	| 38      	|

**Table 2.**  The dataset is split into **71-29**.

To run the model, we have to put the predictors and the response based on our features in the `h2oframe`.
